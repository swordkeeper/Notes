# C++ åŸºç¡€

### å‘½åç©ºé—´

```C++
namespace space_name{
   //  å˜é‡ç±»å‹ å˜é‡;
   // å‡½æ•°è¿”å›ç±»å‹ å‡½æ•°åŸå‹;
    void A(){};
    int b;
}
// ä½¿ç”¨
space_name::A();
space_name::b;
// æˆ–
using namespace space_name;
// æˆ–
using std::cout;
using std::cin;
using std::endl;    // æ¨èç”¨è¿™ç§å¼•ç”¨æ–¹å¼

// ç›´æ¥å†™åœ¨ä¸»æ–‡ä»¶ä¸­çš„å˜é‡ï¼Œéƒ½å±äºåŒ¿åç©ºé—´
// ä½¿ç”¨åŒ¿åç©ºé—´
int num =1; // å…¨å±€å˜é‡ï¼Œ åŒæ—¶ä¹Ÿå±äºå…¨å±€åŒ¿åç©ºé—´
cout<< ::num << endl; // åªé€šè¿‡ä¸¤ä¸ªç‚¹ï¼Œæ¥è¡¨ç¤ºåŒ¿åç©ºé—´
```

å‘½åç©ºé—´å¯ä»¥åˆ†å¼€å†™ï¼Œä½†æ˜¯æœ€ç»ˆè¿˜æ˜¯ä¸€ä¸ªå‘½åç©ºé—´

```c++
namespace A{
    int a = 100;
}
namespace B{        
    void display_b(){
        cout << A::a << endl;    // ç”±äºæ­¤å¤„ä½¿ç”¨åˆ°äº†A::aï¼Œæ‰€ä»¥Aä¸­aå˜é‡å¿…é¡»å®šä¹‰åœ¨ä½¿ç”¨ä¹‹å‰ã€‚å®šä¹‰åœ¨ä¹‹åä¼šå‡ºé”™
    }
}
namespace A{    // åˆ†å¼€å®šä¹‰namespace A
    void display_a(){
        cout << "display:A" << endl;
    }
}
```



### å¸¸é‡

```c++
// åœ¨Cè¯­è¨€ä¸­çš„å¸¸é‡ï¼Œé€šè¿‡ define æ¥å®šä¹‰
#define MAX 5
// C++ ä¸­é€šè¿‡ const å…³é”®å­—æ¥å®šä¹‰
const int b = 15; // å®šä¹‰å¸¸é‡b ï¼Œå¹¶åˆ†é…åˆå§‹å€¼ã€‚ constå¸¸é‡å¿…é¡»åœ¨å®šä¹‰æ—¶ï¼Œåˆ†é…å€¼ã€‚

// const ç›¸æ¯”äº #define çš„ä¼˜åŠ¿åœ¨äºï¼š
// #define æ˜¯é¢„ç¼–è¯‘ï¼Œåªæ˜¯è¿›è¡Œç®€å•çš„ä»£ç æ›¿æ¢
// const ä¸æ˜¯ï¼Œconstæ˜¯åœ¨ç¼–è¯‘æ—¶è¿›è¡Œåˆ†é…èµ‹å€¼ã€‚è€Œä¸”ä¼šè¿›è¡Œç±»å‹çš„æ£€æŸ¥
//
//--------------------------------------
int a = 5;
int b = 10;
const int * p = &a;    // é€šå¸¸å«åš ==> å¸¸é‡æŒ‡é’ˆ
p = &b;  // è¯¥å¥å¯ä»¥æˆåŠŸæ‰§è¡Œ
*p = 1000;  // è¯¥å¥ä¸èƒ½è¢«æ­£å¸¸æ‰§è¡Œã€‚   æŒ‡é’ˆconstï¼Œæ˜¯å®ƒæ‰€æŒ‡çš„å˜é‡ä¸èƒ½è¢«ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆå¼•ç”¨ä¸èƒ½è¢«ä¿®æ”¹ã€‚
//--------------------------------------
int * const p1 = &a;    // =====>æŒ‡é’ˆå¸¸é‡ã€‚
*p1 = 1000;  // å¯ä»¥æ‰§è¡Œ
p1 = &b;     // ä¸èƒ½æˆåŠŸè¢«æ‰§è¡Œ   
// ç»¼ä¸Šï¼Œconst è·Ÿè°è¿‘ï¼Œè°å°±æ˜¯constã€‚å°±ä¸èƒ½è¢«ä¿®æ”¹

// ä¹Ÿå¯ä»¥
const int * const p = &a;   // åŒé‡é”å®šï¼Œéƒ½ä¸èƒ½æ”¹å˜
```



### åˆ›å»ºå †ç©ºé—´

```c++
// C è¯­è¨€æ–¹å¼
int * mm = (int *) malloc(sizeof(int));
*mm = 5;
free(mm);

// C++ æ–¹å¼
int * mm1 = new int(2);
delete mm1; 
int * mm2 = new int[20];
delete [] mm2;  // åˆ é™¤ä¸€ä¸ªæ•°ç»„
```

åŒºåˆ«ï¼š

1. new / delete æ˜¯è¡¨è¾¾å¼ï¼Œmalloc / free æ˜¯åº“å‡½æ•°
2. mallocåªè´Ÿè´£å¼€è¾Ÿç©ºé—´ï¼Œä¸ä¼šè¿›è¡Œåˆå§‹åŒ– ï¼ˆéœ€è¦memsetæ¸…é›¶ï¼‰/ new ä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œé€šè¿‡å‚æ•°ã€‚



### å¼•ç”¨ç±»å‹

å¼•ç”¨ç±»å‹ï¼Œç›¸å½“äºè¯¥ç»Ÿä¸€ä¸ªå˜é‡èµ·å¤šä¸ªåå­—ï¼Œç±»ä¼¼æ›¾ç”¨åã€‚

```c++
int a = 10;
int & b = a;   
b = 5;
cout << a; // è¾“å‡º5ã€‚ å¯¹bçš„ä»»ä½•é€ ä½œï¼Œå°±ç­‰äºå¯¹açš„æ“ä½œã€‚
```

å¼•ç”¨åŒºåˆ«ä¸æŒ‡é’ˆï¼š

1. æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒå­˜å‚¨ç€æŒ‡å‘æ•°æ®çš„ç©ºé—´åœ°å€
2. å¼•ç”¨åªæ˜¯ä¸€ä¸ªåˆ«åã€‚

3. å½“ä½œå‡½æ•°å‚æ•°ã€‚ç”±äºå¼•ç”¨æ˜¯ä¸€ä¸ªå˜é‡çš„åˆ«åï¼Œå› è€Œå®ƒå¿…é¡»``åˆå§‹åŒ–``ï¼Œå› è€Œä¸èƒ½å•ç‹¬å‡ºç°ã€‚å¿…é¡»æœ‰å…³è”çš„å˜é‡ã€‚

è€Œä¸”ä¸€æ—¦è¢«åˆå§‹åŒ–ï¼Œå°±å†ä¹Ÿä¸èƒ½æŒ‡å‘ä¸€ä¸ªæ–°çš„å˜é‡ï¼ˆæˆä¸ºä¸€ä¸ªæ–°çš„å˜é‡çš„åˆ«åï¼‰ã€‚æ­£æ˜¯ç”±äºå¼•ç”¨çš„è¿™ä¸ªç‰¹ç‚¹ï¼Œå³ä¸€æ—¦åˆå§‹åŒ–ï¼Œå°±æ°¸è¿œæ˜¯æŸä¸ªå˜é‡çš„åˆ«åï¼Œå³ç­‰åŒäºconstã€‚``å› è€Œå®ƒå¯ä»¥å½“ä½œå‡½æ•°çš„å‚æ•°æ¥å¯¹å¾…ã€‚``

è¿™æ ·ä»–å°±èƒ½å…‹æœå½¢å¼å‚æ•°èµ‹å€¼çš„ç¼ºç‚¹ã€‚åœ¨å‚æ•°èµ‹å€¼æ—¶ï¼Œä»–è¿˜æ˜¯æŒ‡å‘åŸæ¥æ‰€æŒ‡çš„é‚£ä¸ªå˜é‡ã€‚ 

4. å¼•ç”¨è¿˜å¯ä»¥ç”¨åšå‡½æ•°çš„è¿”å›å€¼

```c++
int arr[5] = {0, 1, 2, 3, 4};
int & tt(int index){
    return arr[index];  // æ­¤å¤„è¿”å›çš„å°±æ˜¯ arr[2]
}
int tt1(int index){
    return arr[index];  // æ­¤å¤„è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„intå˜é‡ï¼Œåªæ˜¯å€¼ç›¸åŒã€‚
    // å½“ä¸€ä¸ªå‡½æ•°è¦è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¿™ç§æƒ…å†µè¡¨ç°å°¤å…¶çªå‡ºã€‚å› ä¸ºä¸åŠ å¼•ç”¨ï¼Œåˆ™ä¼šé¢å¤–çš„ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚
}
```



### å¼ºåˆ¶ç±»å‹è½¬æ¢

``static_cast<double>``ï¼Œç”¨è¯¥å…³é”®å­—æ¥å®ç°è½¬æ¢ã€‚ä¾‹å¦‚

```c++
int a = 5;
double b = static_cast<double> a;
```

``dynamic_cast``

``const_cast``

``reinterpret_cast``



### é‡è½½

é‡è½½overloadï¼Œæ˜¯æŒ‡å‡½æ•°åç›¸åŒï¼Œå‡½æ•°å‚æ•°ä¸åŒã€‚åœ¨å‡½æ•°è°ƒç”¨æ—¶å·®åˆ«è°ƒç”¨çš„ä¸€ç§å½¢å¼ã€‚

å‡½æ•°é‡è½½ä½¿ç”¨çš„æŠ€æœ¯ä¸º``åå­—æ”¹ç¼– name mangling``ã€‚ä»–åœ¨Cä¸­æ˜¯ä¸æ”¯æŒçš„ï¼ˆCæ˜¯å…·æœ‰åå­—å”¯ä¸€æ€§çš„è¯­è¨€ï¼‰ï¼Œæ‰€ä»¥ç”¨gccç¼–è¯‘åˆ™ä¼šæŠ¥é”™ã€‚

ç›¸åç”¨g++ç¼–è¯‘ï¼Œå³c++çš„æ–¹å¼åˆ™ä¸ä¼šã€‚åå­æ”¹ç¼–çš„åŸç†æ˜¯ï¼Œ**åœ¨ç¼–è¯‘çš„æ—¶å€™å°†åå­—ä¸å˜é‡è¿›è¡Œæ‹¼æ¥ï¼Œä»è€Œå½¢æˆä¸€ä¸ªç‹¬ç‰¹çš„åå­—ï¼Œè¿™ä¸ªåå­—åœ¨ç³»ç»Ÿä¸­å”¯ä¸€**ã€‚è¯¥æ–¹å¼ä¼šæ ¹æ®å‡½æ•°å‚æ•°çš„ï¼Œ``ç±»å‹ã€ä¸ªæ•°ã€é¡ºåº``çš„ä¸åŒæ¥åšå‡ºä¸åŒçš„å¯ä»¥å”¯ä¸€ç¡®å®šçš„å‡½æ•°ã€‚

å¯ä»¥é€šè¿‡``g++ -c test.cpp``æ–‡ä»¶ç”Ÿæˆç¼–è¯‘åæœªè¿æ¥çš„æ–‡ä»¶``test.o``ï¼Œç„¶ååœ¨é€šè¿‡``nm test.o``æ¥è§‚å¯Ÿã€‚

```c++
// test.cpp 
int add(int a, int b, int c){     // ä¼šå‘ç°ç¼–è¯‘å åå­—è¢«æ”¹ç¼–ä¸ºã€‚ __Z3addiii
    return a + b + c;
}
int add(int a, int b){   // åå­—è¢«æ”¹ç¼–ä¸º __Z3addii
    return a + b;
}
double add(double a, double b, double c){   // __Z3addddd
    return a + b + c;
}
```



**ä¸ä½¿ç”¨åå­—æ”¹ç¼–**ï¼šæœ‰éœ€c++é»˜è®¤ä¼šå¯¹æ‰€æœ‰å‡½æ•°è¿›è¡Œåå­—æ”¹ç¼–ï¼Œå³ä½¿ä¸ä½¿ç”¨åˆ°é‡è½½ï¼Œå®ƒä¹Ÿä¼šå¯¹åå­—è¿›è¡Œæ”¹ç¼–ã€‚

è‹¥è¦å…¼å®¹Cï¼Œåˆ‡ä¸å¸Œæœ›c++çš„ç¼–è¯‘å¯¹åå­—è¿›è¡Œæ”¹ç¼–è‡ªéœ€è¦ç”¨``extern "C"``

```c++
//extern c
extern "c"{
    int add(int a, int b){   // åå­—è¢«æ”¹ç¼–ä¸º __Z3addii
    return a + b;
	}
}

// é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯¹ extern Cä»£ç è¿›è¡Œ é¢„ç¼–è¯‘åŒ…æ‹¬ã€‚å¯ä»¥å®ç° C/C++æ··åˆç¼–ç¨‹ï¼Œå®ç°å…¼å®¹ç¼–ç¨‹
#ifdef __cplusplus
extern "c"{
#endif
        int add(int a, int b){   // åå­—è¢«æ”¹ç¼–ä¸º __Z3addii
    		return a + b;
		}
#ifdef __cplusplus
}
#endif
```



### inline å‡½æ•°

inline å‡½æ•°ç±»ä¼¼äº``å¸¦å‚æ•°çš„å®``ã€‚ä½¿ç”¨ä»–çš„æ—¶å€™ï¼Œå®ƒä¸å†æ˜¯å‡½æ•°ï¼Œå› è€Œä¸ç”¨åˆ›å»ºå‡½æ•°æ ˆï¼Œæ‰§è¡ŒæŒ‡é’ˆè·³è½¬ç­‰ï¼Œå› è€Œä¼šæé«˜æ‰§è¡Œæ•ˆç‡

```c++
// C ä¸­çš„å¸¦å‚æ•°å®ï¼Œåªè¿›è¡Œæ›¿æ¢ä»£ç 
#define Max(a, b)  (a) > (b) ? (a) : (b)

// C++ inlineå‡½æ•°
inline int Max(int a, int b){   // æ­¤å¤„ä¸å†æ˜¯å‡½æ•°ï¼Œæ•ˆæœç­‰æ•ˆä¸Šé¢çš„å®
    return a > b? a : b;
}
```



### é»˜è®¤å‚æ•°

```c++
int add(int a, int b = 5){  // å¸¦æœ‰é»˜è®¤å‚æ•°çš„å‡½æ•°åº”è¯¥æ”¾åœ¨åˆ—è¡¨åé¢ 
    return a + b;
}

add(10);
// åŒæ—¶ å¦‚æœä¸€ä¸ªå‡½æ•°å‘ç”Ÿäº†é‡è½½ï¼Œé‚£ä¹ˆä¹Ÿæœ‰å¯èƒ½äº§ç”ŸäºŒæ„æ€§é—®é¢˜
```



### string ç±»å‹

string æ˜¯ä¸€ä¸ªæ¨¡ç‰ˆç±»å‹ï¼Œå®šä¹‰åœ¨stdå‘½åç©ºé—´ä¸­

```c++
#include <string>
using std::string;
using std::cout;

void main(void){
    string s1 = "hello";
    string s2 = "world";
    string s3 = s1 + " " + s3;  // string ç±»å‹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯ä»¥è°ƒç”¨è‡ªå·±çš„æ–¹æ³•
    cout << s3;
    cout << s3.size() << endl; // string ç±»å‹çš„æ–¹æ³•
    // è¿˜æœ‰ s.find , s.substr ç­‰æ–¹æ³• 
}
```

string çš„è¿­ä»£å™¨

```c++
 for(string::iterator it = s1.begin(); it != s1.end(); it++){
        cout << *it <<endl;;
 }
```

string åœ¨ c++11 ä¸­ä¹Ÿå¯ä»¥è¢«å½“ä½œ``å®¹å™¨``ã€‚è‹¥è¦ç¼–è¯‘ä¸ºc++11éœ€è¦ç”¨ä¸€ä¸‹å‘½ä»¤``g++ test.cpp -std=c++11``

```c++
for(auto & elem : s1){  // auto å…³é”®å­—ä¼šè‡ªåŠ¨åˆ¤æ–­s1ä¸­çš„æ¯ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆç±»å‹
    cout << elem << endl;
}
```



### ç±»

ç±»çš„å®šä¹‰

```c++
class A{                      // ç±»ä¸struct çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œstructä¸­çš„æˆå‘˜é»˜è®¤ä¸ºpublicï¼Œè€Œç±»é»˜è®¤private
    private: 
    	int a;    // ç§æœ‰
    	void func1(){};  // ç§æœ‰
    public: 
    	int b;  // å…¬æœ‰
    	void func2(){};
    protected: int c;
};   // æ³¨æ„ç±»çš„ç»“å°¾éœ€è¦ä¸€ä¸ªåˆ†å·

```

ç±»å¤–å®šä¹‰çš„å‡½æ•°

```c++
class B{
    private:
    	int func3(){ return 0; };   // ç±»å†…éƒ¨å¯ä»¥å®šä¹‰ æˆå‘˜å‡½æ•°
    	int func4(); // å£°æ˜å‡½æ•°ï¼Œç„¶åç”±ç±»å¤–å®šä¹‰ã€‚æ­¤å‡½æ•°ä¸ºprivateå±æ€§
}

int B::func4(){    // ç±»å¤–å®šä¹‰æˆå‘˜å‡½æ•°ã€‚éœ€è¦å…ˆåœ¨ç±»é‡Œé¢å£°æ˜
    return 5;
}
```

æ„é€ å‡½æ•°

1. åå­—ä¸ç±»åç›¸åŒ

2. ä¸èƒ½æœ‰è¿”å›å€¼ï¼Œä¸èƒ½è®¾ç½®è¿”å›ç±»å‹

3. ç³»ç»Ÿä¼šé»˜è®¤æä¾›ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ä½†æ˜¯ä¸€æ—¦ç”¨æˆ·è‡ªå®šä¹‰æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¸å†æä¾›é»˜è®¤æ— å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ç”¨æˆ·å°±åªèƒ½ä½¿ç”¨è‡ªå·±çš„æ„é€ å‡½æ•°

4. ```c++
    class C{
        private:
        	int _ix;  // ä¸¤ä¸ªæˆå‘˜å˜é‡
        	int _iy; 
        public:
        	 // ä¸ºäº†å¥å£®æ€§ï¼Œè¡¥å…¨é»˜è®¤æ„é€ å‡½æ•°
        	C(): _ix(0), _iy(0)  // åˆå§‹åŒ–è¯­å¥
            {};       // æ„é€ å‡½æ•°é€»è¾‘
        
        	// é‡è½½æ„é€ å‡½æ•°
        	C(int ix, int iy):_ix(ix), _iy(iy)
            {}; // æ„é€ å‡½æ•°å…¶ä»–é€»è¾‘
        
        	// è¡¥å…¨ç³»ç»Ÿè‡ªå¸¦çš„ å¤åˆ¶æ„é€ å‡½æ•°ï¼Œå³ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼Œå»åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚
        	// ç”¨æ³•å³ï¼ŒC c1;  C c2(c1); C c3 = c1;  ç”¨å¯¹è±¡c1æ¥åˆå§‹åŒ–å¯¹è±¡c2å’Œc3
        	C(const C & rhs)  // å¼•ç”¨ç¬¦å·ï¼Œä¸èƒ½å»æ‰ï¼Œå¦åˆ™å°±ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”ä¼šå‡ºç°æ— é™é€’å½’çš„æƒ…å†µã€‚
    }
    ```

5. æ„é€ å‡½æ•°æ¯”è¾ƒå¤æ‚ã€‚ä»–ä¼šåœ¨å¾ˆå¤šæƒ…å†µä¸‹è¢«è°ƒç”¨ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
    - åˆ›å»ºæ—¶è°ƒç”¨
    - å‡½æ•°ä¼ é€’å¯¹è±¡å‹å‚æ•°ï¼Œè€Œä¸”å‚æ•°ä¸æ˜¯å¼•ç”¨æ—¶å€™ï¼Œæ„é€ å‡½æ•°ä¼šåœ¨å­å‡½æ•°ä¸­çš„å½¢å‚ä¸­æ„é€ 
    - returnè¯­å¥è¿”å›å€¼æ—¶ï¼Œè‹¥è¿”å›å€¼ä¸ä¸ºå¼•ç”¨ã€‚åˆ™åœ¨è¿”å›æ—¶ï¼Œä¹Ÿä¼šè¿›è¡Œä¸€æ¬¡å½¢å‚å’Œå®å‚çš„ä¼ é€’ï¼ˆè°ƒç”¨æ„é€ å‡½æ•°ï¼‰

ææ„å‡½æ•°

1. ç³»ç»Ÿä¼šé»˜è®¤æä¾›ä¸€ä¸ªææ„å‡½æ•°